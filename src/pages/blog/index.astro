---
import Layout from "../../layout/Layout.astro";

type Blog = {
    slug: string;
    title: string;
    date: string;
};

const modules = import.meta.glob<{
    frontmatter: { title: string; date: string };
}>("/src/content/blog/*.md", { eager: true });

const blogs: Blog[] = Object.entries(modules)
    .map(([path, mod]) => {
        const fileName = path.split("/").pop()!;
        const slug = fileName.replace(/\.md$/, "");

        return {
            slug,
            title: mod.frontmatter.title,
            date: mod.frontmatter.date,
        };
    })
    .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());
---

<Layout title="Blog">
    <section class="py-10">
        <div class="rounded-2xl border border-amber-200/10 bg-gradient-to-r from-amber-500/10 via-orange-500/5 to-transparent p-6">
            <p class="text-xs uppercase tracking-[0.2em] text-amber-300">Journal</p>
            <h1 class="mt-2 text-4xl font-black text-white">Blog</h1>
            <p class="mt-3 max-w-2xl text-gray-300">Thoughts, notes, and updates from recent work.</p>
        </div>

        <div class="mt-8 grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
            {
                blogs.map((b) => (
                    <a
                        href={`/blog/${b.slug}`}
                        class="group relative block overflow-hidden rounded-2xl border border-white/10 bg-gray-900 p-6 transition duration-300 hover:-translate-y-1 hover:border-amber-300/50 hover:bg-gray-900/80"
                    >
                        <div class="absolute inset-0 bg-gradient-to-br from-amber-400/10 via-transparent to-transparent opacity-0 transition group-hover:opacity-100"></div>

                        <div class="relative">
                            <div class="flex items-center justify-between text-xs uppercase tracking-wider text-gray-400">
                                <span>Article</span>
                                <span>{new Date(b.date).toLocaleDateString()}</span>
                            </div>

                            <h2 class="mt-4 text-xl font-bold leading-snug text-gray-100 group-hover:text-amber-200 transition">
                                {b.title}
                            </h2>

                            <p class="mt-6 inline-flex items-center text-sm font-semibold text-amber-300 group-hover:text-amber-200">
                                Read blog ->
                            </p>
                        </div>
                    </a>
                ))
            }
        </div>
    </section>
</Layout>
